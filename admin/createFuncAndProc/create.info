create view administrator.hn_ky_kpi as  select a.branch,a.aracde,a.agntnum,a.agntname,a.agtype,a.chdrnum,a.cnttype,a.trandate,  a.acctamt_std,b.statcode  from administrator.hn_acctinfo a,administrator.hn_chdrinfo b  where b.chdrnum = a.chdrnum  and a.cnttype in('A11','ABF','CFC','CFD','CFE','CFR','FIC')  and acctamt_std >=200000  and b.statcode = 'IF'  and a.agtype in('TA','SA','SM','SD','AS','SS','UM','AD','SE','HD','TS','RC',  'BC','BD','BM','BP','BY','BZ','HA')  union  select * from  (select administrator.stationtobranch(station) as branch,medi_code as aracde,agency_code as agntnum,'-' as agntname,  '-' as agtype,bm_cert as chdrnum,kinds as cnttype,  year(jf_rq)*10000+month(jf_rq)*100+day(jf_rq) as trandate,jf_je as acctamt_std,  detail_flag as statcode  from hn_basdata where kinds = '523' and detail_flag = 'YX' and jf_je >=200000  and jf_way = 12 ) a
DB20000I  The SQL command completed successfully.

create view administrator.hn_zj_branch as  select a.branch,a.name,b.aracde,b.shortname,c.descitem,c.shortdesc from  (select branch,name from administrator.hn_branch where branch <> 'D') a left join  (select branch,aracde,shortname from administrator.hn_aracde where xqflag = 'N'  and agentflag = 'N') b on b.branch = a.branch left join  (select aracde,descitem,shortdesc from administrator.hn_zcntinfo  where validflag = '1' OR descitem in('G0G0304','B0B0808') ) c on c.aracde = b.aracde
DB20000I  The SQL command completed successfully.

create view administrator.part_cnt_kpi as  select b.branch,b.aracde,b.partname,b.partnum,b.teamname,b.teamnum,a.chdrnum,  a.cnttype,a.acctamt,a.acctamt_std,  a.trandate,a.batc_type,a.agntnum,a.agntname,a.agtype  from hn_acctinfo a,hn_agntinfo b  where a.agntnum = b.agntnum and  a.agtype in('TA','SA','SM','SD','AS','SS','UM','AD','SE','HD','TS','RC')  and batctrcde<>'TGJC'
DB20000I  The SQL command completed successfully.

CREATE view ADMINISTRATOR.V_BA_XUQIACCT (bm_cert,station,medi_code,kinds,jfyears,qd_rq,ys_rq,niandu,    jf_rq,jf_je,jf_kind,pt_rq,agency_code,agency_group,t_insure_nu,insure_nu) as     select bm_cert,station,medi_code,kinds,jfyears,(rq_start-1 days) qd_rq,      ((rq_start-1 days)+(year(jf_rq-rq_start)+ int((month(jf_rq-rq_start)+4)/12)) years) ys_rq,       year(jf_rq-rq_start)+ int((month(jf_rq-rq_start)+4)/12)+1 niandu,        jf_rq,jf_je,jf_kind,((rq_start-1 days)+(year(jf_rq-rq_start)+ int((month(jf_rq-rq_start)+4)/12)+1) years),          agency_code,agency_group,t_insure_nu,insure_nu from administrator.hn_basdata    where jf_way=12 and (app_flag='2' or (app_flag='PG' and detail_flag='BF'))
DB20000I  The SQL command completed successfully.

create view v_branch (branch,name,aracde,araname,shortname1,validflag)  as  SELECT a.branch,a.name,b.aracde,b.araname,b.shortname1,b.validflag  FROM administrator.hn_branch a,administrator.hn_aracde b  WHERE a.branch=b.branch
DB20000I  The SQL command completed successfully.

create view  v_hn_mssuser  (BRANCH_ID,ARACDE,USER_ID,USER_NAME,PASSWORD)  as   SELECT BRANCH_ID,ARACDE,USER_ID,USER_NAME,PASSWORD  FROM mss_user_info WHERE USER_ID<>'henan'
DB20000I  The SQL command completed successfully.

create view v.dxxq as  select chdrnum,trandate,sum(acctamt) as bf,occdate,agtype,(int(effdate/10000)*12+  mod(int(effdate/100),int(effdate/10000)))-  (int(occdate/10000)*12+mod(int(occdate/100),int(occdate/10000))) as month  from administrator.hn_xuqiacct where agtype in('TR','TB') and batctrcde<>'TGJC'  group by chdrnum,trandate,occdate,agtype,effdate having (int(effdate/10000)*12+  mod(int(effdate/100),int(effdate/10000)))-  (int(occdate/10000)*12+mod(int(occdate/100),int(occdate/10000))) >=12
DB20000I  The SQL command completed successfully.

create view v.gx_xzfx as  select branch,aracde,chdrnum,acctamt,jfr,trandate,cnttype,surname,agntnum,agntname,zcllctor,  zcllname,statcode,flag,currfrom,amount18,amount23,amount11,create_time,mark from  (select distinct a.*,currfrom,amount18,amount23,amount11,create_time,case when acctamt < amount11 then 1 end as mark from  (select * from (  select a.branch as branch,a.aracde as aracde,a.chdrnum,sum(a.acctamt) as acctamt,a.trandate as jfr,  a.trandate,a.cnttype,b.surname,b.agntnum,b.agntname,b.zcllctor,b.zcllname,statcode,'1' as flag  from hn_acctinfo a,hn_xuqidetail b where a.chdrnum = b.chdrnum  group by a.branch,a.aracde,  a.chdrnum,a.trandate,a.cnttype,b.surname,b.agntnum,b.agntname,b.zcllctor,b.zcllname,statcode  union all  select a.agntbr as branch,a.agntara as aracde,a.chdrnum,sum(a.acctamt) as acctamt,  a.trandate as jfr,a.effdate as trandate,a.cnttype,b.surname,b.agntnum,b.agntname,  b.zcllctor,b.zcllname,b.statcode,'2' as flag  from hn_xuqiacct a,hn_xuqidetail b where a.chdrnum = b.chdrnum  group by a.agntbr,a.agntara,a.chdrnum,a.trandate,a.effdate,a.cnttype,b.surname,b.agntnum,  b.agntname,b.zcllctor,b.zcllname,b.statcode  ) a ) a left join  (select distinct * from administrator.hn_xjjz a where create_time =  (select max(create_time) from administrator.hn_xjjz b where a.chdrnum = b.chdrnum))b  on b.chdrnum = a.chdrnum ) a where statcode in('IF','LA')  and cnttype in('U02','U05')
DB20000I  The SQL command completed successfully.

create  view v.kqinfo as select branch,aracde,badgenumber as kqh ,b.name,checktime,a.sn,d.alias from zknet.checkinout a, zknet.userinfo b, zknet.jivegroup c, zknet.iclock d where a.userid = b.userid and b.defaultdeptid = c.id and a.sn = d.sn
DB21034E  The command was processed as an SQL statement because it was not a 
valid Command Line Processor command.  During SQL processing it returned:
SQL0204N  "ZKNET.CHECKINOUT" is an undefined name.  SQLSTATE=42704

create  view v.msg_kq as select trim(administrator.getbranchname(branch)) as branch,  trim(administrator.getaracdename(aracde)) as aracde from  (select a.branch,a.aracde,b.cqrl from (select BRANCH,ARACDE from administrator.hn_aracde where agentflag = 'N' and xqflag = 'N') a left join (select branch,aracde,count(distinct kqh)cqrl from v.kqinfo where aracde <> ''  and aracde <> '*' and date(checktime) = date(current timestamp) group by branch,aracde)  b on b.branch=a.branch and b.aracde = a.aracde) a  where cqrl is null
DB21034E  The command was processed as an SQL statement because it was not a 
valid Command Line Processor command.  During SQL processing it returned:
SQL0204N  "V.KQINFO" is an undefined name.  SQLSTATE=42704

create view v.test as  select 'TZ' as series,c.branch,substr(medi_code,1,2) as aracde,bm_cert as chdrnum,  kinds as cnttype,jf_je as acctamt,jf_je as acctamt_std,char(jf_way) as freq,jfyears as period,  app_flag as statcode,agency_code as agntnum,'' as agntname,administrator.date_int(a.jf_rq) as trandate  from administrator.hn_basdata a,administrator.hn_branch c  where (a.agency_code like '808%' or  a.agency_code like '%A') and a.station = c.station  and app_flag IN ('1','WT')
DB20000I  The SQL command completed successfully.

create  view v.ybnew as select a.*,b.bbxs,case when b.isdgx is null and sort = 'g' then 'Y' else b.isdgx end as isdgx from (select SERIES,BRANCH,ARACDE,CHDRNUM,CNTTYPE,ACCTAMT,ACCTAMT_STD, case when FREQ = '12' and sort = 'y' then 'Q' when sort = 'g' and freq <> 'S' then 'Q' else 'D' end as freq, PERIOD,STATCODE,AGNTNUM,AGNTNAME,TRANDATE,SORT,TEAMNUM,TEAMNAME,STATCODE2 from hnii29.hn_ybyj ) a left join (select series,cnttype,freq,period,bbxs,isdgx from hnii29.hn_ybkinds )  b on a.series=b.series and a.freq=b.freq and a.period = b.period AND a.cnttype=b.cnttype
DB21034E  The command was processed as an SQL statement because it was not a 
valid Command Line Processor command.  During SQL processing it returned:
SQL0601N  The name of the object to be created is identical to the existing 
name "V.YBNEW" of type "VIEW".  SQLSTATE=42710

create  view v.ybssyj_yb as select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,premium as acctamt,premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.make_time) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta19 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and app_flag IN ('1','WT')  and make_time=DATE(current timestamp) and (a.agency_code like '808%' or  a.agency_code like '%A') union all select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,-premium as acctamt,-premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.rq_make) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta1b9 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and pg_type in ('WT','BT')  and a.rq_make=DATE(current timestamp) and (a.agency_code like '808%' or  a.agency_code like '%A') union all select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,premium as acctamt,premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.make_time) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta19 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and app_flag IN ('1','WT')  and make_time=DATE(current timestamp) and a.agency_group IN ('08900069','08900070','08900071') union all select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,-premium as acctamt,-premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.rq_make) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta1b9 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and pg_type in ('WT','BT')  and a.rq_make=DATE(current timestamp) and a.agency_group IN ('08900069','08900070','08900071') union all select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,premium as acctamt,premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.make_time) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta19 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and app_flag IN ('1','WT')  and make_time=DATE(current timestamp) and a.agency_code not in (select agency_code from administrator.agency where agency_group IN ('08900069','08900070','08900071')) and a.agency_code not like '808%' and a.agency_code not like '%A' and a.agency_code not like '%WY%' union all select char('TZ') as series,c.branch,substr(a.station_a,3,2) as aracde,bm_cert as chdrnum,kinds as cnttype,-premium as acctamt,-premium as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.rq_make) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.rta1b9 a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where  a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and pg_type in ('WT','BT')  and a.rq_make=DATE(current timestamp) and a.agency_code not in (select agency_code from administrator.agency where agency_group IN ('08900069','08900070','08900071')) and a.agency_code not like '808%' and a.agency_code not like '%A' and a.agency_code not like '%WY%'
DB21034E  The command was processed as an SQL statement because it was not a 
valid Command Line Processor command.  During SQL processing it returned:
SQL0204N  "ADMINISTRATOR.RTA19" is an undefined name.  SQLSTATE=42704

create view v.ybyj_xq as  select char('TZ') as series,agntbr as branch,agntara as aracde,chdrnum,cnttype,  acctamt,statcode,agntnum,agntname,trandate,'g' as sort  from administrator.hn_xuqiacct where agtype IN ('BY','BZ')  union all  select char('TZ') as series,a.agntbr as branch,a.agntara as aracde,a.chdrnum,a.cnttype,  a.acctamt,a.statcode,a.agntnum,a.agntname,a.trandate,'g' as sort  from administrator.hn_xuqiacct a,administrator.zcdrpf c  where a.chdrnum = c.chdrnum and  (c.reportag01 like '808%' or  c.reportag01 like '%A')  and a.cnttype IN('AB8','AD7')  union all  select char('TZ') as series,c.branch,substr(medi_code,1,2) as aracde,bm_cert as chdrnum,  kinds as cnttype,jf_je as acctamt,app_flag as statcode,agency_code as agntnum,  '' as agntname,administrator.date_int(a.jf_rq) as trandate,'y' as sort  from administrator.hn_basdata a,administrator.hn_branch c  where (a.agency_code like '808%' or  a.agency_code like '%A') and a.station = c.station  and app_flag = '2' and kinds = '523'    union all  select char('FIC') as series,agntbr as branch,agntara as aracde,chdrnum,cnttype,  acctamt,statcode,agntnum,agntname,trandate,'g' as sort  from administrator.hn_xuqiacct where  agtype IN ('BC','BD','BM','BP')  union all  select char('FIC') as series,a.agntbr as branch,a.agntara as aracde,a.chdrnum,a.cnttype,  a.acctamt,a.statcode,a.agntnum,a.agntname,a.trandate,'g' as sort  from administrator.hn_xuqiacct a,administrator.zcdrpf c  where a.chdrnum = c.chdrnum and  c.reportag01 in (select agency_code from administrator.agency where agency_group  IN ('08900069','08900070','08900071'))  and a.cnttype IN('AB8','AD7')  union all  select char('FIC') as series,c.branch,substr(medi_code,1,2) as aracde,bm_cert as chdrnum,  kinds as cnttype,jf_je as acctamt,app_flag as statcode,agency_code as agntnum,  '' as agntname,administrator.date_int(a.jf_rq) as trandate,'y' as sort  from administrator.hn_basdata a,administrator.hn_branch c  where a.agency_code in (select agency_code from administrator.agency where agency_group  IN ('08900069','08900070','08900071')) and a.station = c.station  and app_flag ='2' and kinds = '523'  union all  select char('SQ') as series,a.agntbr as branch,a.agntara as aracde,a.chdrnum,a.cnttype,  a.acctamt,a.statcode,a.agntnum,a.agntname,a.trandate,'g' as sort  from administrator.hn_xuqiacct a,administrator.zcdrpf c  where a.chdrnum = c.chdrnum and  c.reportag01 not in (select agency_code from administrator.agency where agency_group  IN ('08900069','08900070','08900071')) and c.reportag01 not like '808%' and  c.reportag01 not like '%A' and a.cnttype IN('AB8','AD7')  union all  select char('SQ') as series,c.branch,substr(medi_code,1,2) as aracde,bm_cert as chdrnum,  kinds as cnttype,jf_je as acctamt,app_flag as statcode,agency_code as agntnum,  '' as agntname,administrator.date_int(a.jf_rq) as trandate,'y' as sort  from administrator.hn_basdata a,administrator.hn_branch c  where a.agency_code not in (select agency_code from administrator.agency where agency_group  IN ('08900069','08900070','08900071')) and a.agency_code not like '808%' and  a.agency_code not like '%A' and a.agency_code not like '%WY%' and a.station = c.station  and app_flag ='2'
DB20000I  The SQL command completed successfully.

create view view.ybyj as select char('TZ') as series,a.branch,a.aracde,a.chdrnum,a.cnttype,acctamt,acctamt_std,freq,smallint(period) as period,b.statcode, a.agntnum,a.agntname as name,a.trandate,'g' as sort,a.teamnum,a.teamname,'' as statcode2 from administrator.hn_acctinfo a,administrator.hn_chdrinfo b where a.chdrnum = b.chdrnum and agtype IN ('BY','BZ') union all select char('TZ') as series,a.branch,a.aracde,a.chdrnum,a.cnttype,acctamt,acctamt_std,freq,smallint(period) as period,b.statcode, c.reportag01 as agntnum,d.name,a.trandate,'g' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.hn_acctinfo a,administrator.hn_chdrinfo b,administrator.hn_zcdrpf c,administrator.hn_agency d,administrator.hn_agency_group e where a.chdrnum = b.chdrnum and a.chdrnum = c.chdrnum and c.reportag01=d.agency_code and d.agency_group = e.agency_group and (c.reportag01 like '808%' or  c.reportag01 like '%A') and a.cnttype IN('AB8','U12','U14','AD7') union all select char('TZ') as series,c.branch,medi_code as aracde,bm_cert as chdrnum,kinds as cnttype,jf_je as acctamt,jf_je as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.jf_rq) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,a.detail_flag as statcode2 from administrator.hn_basdata a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where (a.agency_code like '808%' or  a.agency_code like '%A') and a.station = c.station and a.agency_code=d.agency_code  and d.agency_group = e.agency_group and app_flag IN ('1','WT') and kinds = '523' union all select char('FIC') as series,a.branch,a.aracde,a.chdrnum,a.cnttype,acctamt,acctamt_std,freq,smallint(period) as period,b.statcode, a.agntnum,a.agntname as name,a.trandate,'g' as sort,a.teamnum,a.teamname,'' as statcode2 from administrator.hn_acctinfo a,administrator.hn_chdrinfo b where a.chdrnum = b.chdrnum and agtype IN ('BC','BD','BM','BP') union all select char('FIC') as series,a.branch,a.aracde,a.chdrnum,a.cnttype,acctamt,acctamt_std,freq,smallint(period) as period,b.statcode, c.reportag01 as agntnum,d.name,a.trandate,'g' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.hn_acctinfo a,administrator.hn_chdrinfo b,administrator.hn_zcdrpf c,administrator.hn_agency d,administrator.hn_agency_group e where a.chdrnum = b.chdrnum and a.chdrnum = c.chdrnum and c.reportag01=d.agency_code and d.agency_group = e.agency_group and c.reportag01 in (select agency_code from administrator.hn_agency where agency_group IN ('08900069','08900070','08900071')) and a.cnttype IN('AB8','U12','U14','AD7') union all select char('FIC') as series,c.branch,medi_code as aracde,bm_cert as chdrnum,kinds as cnttype,jf_je as acctamt,jf_je as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.jf_rq) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,a.detail_flag as statcode2 from administrator.hn_basdata a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where a.agency_code in (select agency_code from administrator.hn_agency where agency_group IN ('08900069','08900070','08900071')) and a.station = c.station and a.agency_code=d.agency_code and d.agency_group = e.agency_group and app_flag IN ('1','WT') and kinds = '523' union all select char('SQ') as series,a.branch,a.aracde,a.chdrnum,a.cnttype,acctamt,acctamt_std,freq,smallint(period) as period,b.statcode, c.reportag01 as agntnum,d.name,a.trandate,'g' as sort,e.agency_group as teamnum,e.group_name as teamname,'' as statcode2 from administrator.hn_acctinfo a,administrator.hn_chdrinfo b,administrator.hn_zcdrpf c,administrator.hn_agency d,administrator.hn_agency_group e where a.chdrnum = b.chdrnum and a.chdrnum = c.chdrnum and c.reportag01=d.agency_code and d.agency_group = e.agency_group and c.reportag01 not in (select agency_code from administrator.hn_agency where agency_group IN ('08900069','08900070','08900071')) and c.reportag01 not like '808%' and c.reportag01 not like '%A' and a.cnttype IN('AB8','U12','U14','AD7') union all select char('SQ') as series,c.branch,medi_code as aracde,bm_cert as chdrnum,kinds as cnttype,jf_je as acctamt,jf_je as acctamt_std, char(jf_way) as freq,smallint(jfyears) as period,app_flag as statcode,a.agency_code as agntnum,d.name, administrator.date_int(a.jf_rq) as trandate,'y' as sort,e.agency_group as teamnum,e.group_name as teamname,a.detail_flag as statcode2 from administrator.hn_basdata a,administrator.hn_branch c,administrator.hn_agency d,administrator.hn_agency_group e where a.agency_code not in (select agency_code from administrator.hn_agency where agency_group IN ('08900069','08900070','08900071')) and a.agency_code not like '808%' and a.agency_code not like '%A' and a.agency_code not like '%WY%' and a.station = c.station and a.agency_code=d.agency_code and d.agency_group = e.agency_group and app_flag IN ('1','WT')
DB20000I  The SQL command completed successfully.

